<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Shutlock 2025 - Ice Cream · xKayniT
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="xKayniT">
<meta name="description" content="Shutlock 2025 - Ice Cream">
<meta name="keywords" content="blog,developer,cybersecurity">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Shutlock 2025 - Ice Cream">
  <meta name="twitter:description" content="Shutlock 2025 - Ice Cream">

<meta property="og:url" content="http://localhost:1313/posts/shutlock_2025_ice_cream/">
  <meta property="og:site_name" content="xKayniT">
  <meta property="og:title" content="Shutlock 2025 - Ice Cream">
  <meta property="og:description" content="Shutlock 2025 - Ice Cream">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-06-30T00:00:00+00:00">
    <meta property="article:tag" content="Xkaynit">
    <meta property="article:tag" content="Post">
    <meta property="article:tag" content="Web">




<link rel="canonical" href="http://localhost:1313/posts/shutlock_2025_ice_cream/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/linuxprofil.jpg" sizes="any">
<link rel="icon" type="image/png" href="/images/linuxprofil.jpg" sizes="32x32">
<link rel="icon" type="image/png" href="/images/linuxprofil.jpg" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      xKayniT
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Posts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/shutlock_2025_ice_cream/">
              Shutlock 2025 - Ice Cream
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2025-06-30T00:00:00Z">
                June 30, 2025
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              4-minute read
            </span>
          </div>
          <div class="authors">
  <i class="fa-solid fa-user" aria-hidden="true"></i>
    <a href="/authors/xkaynit/">Xkaynit</a></div>

          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/xkaynit/">Xkaynit</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/post/">Post</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/web/">Web</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h1 id="shutlock-2025">
  Shutlock 2025
  <a class="heading-link" href="#shutlock-2025">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<h2 id="ice-cream">
  Ice Cream
  <a class="heading-link" href="#ice-cream">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ol>
<li>Introduction</li>
</ol>
<p>The purpose of this article is a writeup for Ice Cream challenge which was one of the web challenges for the Shutlock CTF 2025. Here is the description of it :</p>
<p><em>Bienvenue dans le challenge Ice Cream !</em></p>
<p><em>Tu dois trouver l’ingrédient secret des glaces de &ldquo;PAPI glace&rdquo;, le plus grand vendeur de glace de tout Cannes</em>.</p>
<p><em>You have to generate a token and launch a dynamic instance to start the challenge.</em></p>
<ol start="2">
<li>Analysis</li>
</ol>
<p>The first step when I am in front of the interface is to analyse it and what I am able to do. The screenshot below shows the interface with a list of ingredients and it is possible to go through each with the corresponding description. Another interesting thing is the Json Web Token(JWT) available when a request is done, a role is associated with the default one : <strong>&ldquo;simple_utilisateur&rdquo;</strong>.</p>
<p><img src="https://gist.github.com/user-attachments/assets/8a69c950-5f9c-4179-8aa7-4b9e36e57407" alt="Challenge web interface"></p>
<p>Once I have take a look at the general informations available, it is time to go further. When I click on an ingredient, some parameters appears in the URL such as <strong>dir</strong> and <strong>file</strong>. The first thing to do when I see this is to try a directory traversal attack with replacing the current <strong>dir</strong> value by <strong>/</strong> to be at the root of the application.</p>
<p><img src="https://gist.github.com/user-attachments/assets/2371fa26-f508-4726-8888-9bb019ae5719" alt="Path traversal"></p>
<p>I have now access to other files, let us go deeper into that. Some files seems to be interesting :</p>
<ul>
<li>
<p>admin.php and admin.txt -&gt; admin.php is here to create user token depending on some informations(code explanation below) and admin.txt contains admin token</p>
</li>
<li>
<p>auth.php -&gt; this file allows to search for the other roles available linked to JWT</p>
</li>
<li>
<p>secrets.txt -&gt; the secret used to generate the token</p>
</li>
<li>
<p>role.txt -&gt; the roles availables</p>
</li>
</ul>
<p>All text files are inaccessible without the correct rights. However, many important informations can be found in <strong>admin.php</strong> files because this is the file which generate the user token.</p>
<pre tabindex="0"><code>function is_admin($jwt, $secret, $adminRole) {
    $payload = verify_jwt_hs256($jwt, $secret);
    if (!$payload) return false;
    return isset($payload[&#39;role&#39;]) &amp;&amp; strtoupper(trim($payload[&#39;role&#39;])) === strtoupper(trim($adminRole));
}
</code></pre><p>The first information I see it is the need to have the correct role($adminROle) and secret($secret) to access to text files otherwise a token with <strong>&ldquo;simple_utilisateur&rdquo;</strong> role is created. Another important information to keep in mind is a <strong>debug</strong> endpoint exists to execute command but I need to have an admin token to use it. Now I can start to seek for the expected role.</p>
<p><img src="https://gist.github.com/user-attachments/assets/f8511b2b-9d31-4f1d-a5c8-1c9b78d1a7a0" alt="SQL Injection"></p>
<p>I quickly identified an SQL Injection on the input of auth.php with the returned message when I fill the input with an apostrophe character. With searching and trying some of the payload available <a href="https://github.com/payloadbox/sql-injection-payload-list"  class="external-link" target="_blank" rel="noopener">here</a>, I listed all the <strong>auth</strong> table and got the correct role(PAPI-JE-SUIS-UN-ADMIN). I can now focus on the secret. For this steps, I used <strong>jwt_tool</strong> available on <strong>Exegol</strong> which can brute-force secret and tamper token.</p>
<p><img src="https://gist.github.com/user-attachments/assets/70ebeafc-ec03-42bf-95cd-7e115f96caf4" alt="Token brute-force"></p>
<p>With using <strong>rockyou</strong> wordlists during few seconds a match is established :<strong>icecream</strong>. I have know all the informations to create the expected token with the same tool. In <strong>admin.php</strong> file I learn about the existence of the <strong>debug</strong> endpoint, this is the next step after created the token.</p>
<p><img src="https://gist.github.com/user-attachments/assets/ded09311-8f63-41ef-be98-1416c582d350" alt="Debug endpoint"></p>
<p>Firstly, I try a <strong>ls</strong> to show the files in the current directory. I remembered that the text in an ingredient file talks about an hidden file, so to be sure I added <strong>-a</strong> option to display this type of files.</p>
<p><img src="https://gist.github.com/user-attachments/assets/49db2031-4945-49e1-a9b9-877836814169" alt="Flag in hidden file"></p>
<p>By browsing, going in the <strong>secrets</strong> folder and using <strong>cat</strong> command the flag is display and this is the end of this challenge !</p>
<ol start="3">
<li>Solution</li>
</ol>
<p>The flag is display when the correct command on the hidden file is done. This approach of the challenge is new for me because it involves in many steps to retrieve the flag in a <strong>&ldquo;black box&rdquo;</strong> environment type. This was a very enriching experience and let me go deeper on the analysis phase for the next challenges !</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2024 -
    
    2025
     xKayniT 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
